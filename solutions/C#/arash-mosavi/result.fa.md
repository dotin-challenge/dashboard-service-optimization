# نتیجه - PR #1 ([Solution] High-Traffic Dashboard Optimization - arash.mousavi)
نویسنده: `arash-mosavi`
لینک: https://github.com/dotin-challenge/dashboard-service-optimization/pull/1
زبان: فارسی | [English](./result.md)

## خلاصه
این راهکار یک لایه کش درون‌حافظه‌ای با `IMemoryCache` پیاده‌سازی می‌کند و با استفاده از `SemaphoreSlim` و الگوی double-check از Cache Stampede جلوگیری می‌کند. در حالت Miss تنها یک درخواست داده را تولید می‌کند و پس از آن بقیه از کش پاسخ می‌گیرند. برای انقضا از ترکیب انقضای مطلق ۱ ساعت و انقضای لغزنده ۳۰ دقیقه استفاده شده است. API روی `GET /api/dashboard` قرار دارد و لاگ‌گیری به همراه زمان‌سنجی (Stopwatch) انجام می‌شود.

نکته: طبق README هر دسترسی باید اعتبار را ۳۰ دقیقه از زمان خواندن تمدید کند. ترکیب Absolute(1h)+Sliding(30m) باعث سقف‌دار شدن تمدید می‌شود و می‌تواند با این رفتار مورد انتظار در خواندن‌های نزدیک به پایان اعتبار تضاد داشته باشد. Sliding-only یا تازه‌سازی Absolute روی هر خواندن مناسب‌تر است.

## امتیازدهی
| معیار | وزن | امتیاز (0-100) | وزنی | توضیحات |
|------|-----|-----------------|------|---------|
| درستی پیاده‌سازی | 40% | 85 | 34.0 | تضاد Absolute+Sliding با قانون TTL README |
| کیفیت کد و خوانایی | 25% | 85 | 21.25 | همه کلاس‌ها در یک فایل؛ ناسازگاری نام‌گذاری جزئی |
| همزمانی و مدیریت خطا | 10% | 90 | 9.0 | عدم استفاده از CancellationToken؛ پاسخ 500 عمومی |
| کارایی و رفتار کش | 10% | 90 | 9.0 | قفل سراسری قابل قبول؛ سربار ناچیز |
| مستندسازی | 5% | 80 | 4.0 | ناهماهنگی مسیر/نام؛ توضیحات کوتاه |
| سرعت ارسال | 5% | 100 | 5.0 | اولین ارسال صحیح |
| مجموع |  |  | 82.25 |  |

## نقاط قوت
- استفاده صحیح از `IMemoryCache` و تنظیمات منطقی.
- جلوگیری از Stampede با `SemaphoreSlim` و double-check.
- تفکیک از طریق `IDashboardService` و لاگ‌گیری مناسب.
- کنترلر ساده با پاسخ‌های 200/500 روشن.

## موارد قابل بهبود
- سیاست انقضا: برای تمدید نامحدود، Absolute را حذف یا روی هر خواندن تازه‌سازی کنید.
- ساختاردهی: جدا کردن کلاس‌ها در فایل‌های مستقل.
- propagation `CancellationToken` برای عملیات طولانی.
- یکسان‌سازی نام‌ها/مسیرها در README و کد.

## توضیحات امتیاز
- Correctness: ترکیب Absolute+Sliding با تمدید ۳۰ دقیقه‌ای بدون سقف در تضاد است.
- Code Quality: همه انواع در یک فایل؛ ولی ساختار و DI قابل قبول است.
- Concurrency/Error: Stampede کنترل شده؛ خطاها به قالب استاندارد (problem+json) نگاشت نشده‌اند.
- Performance: قفل سراسری با سربار کم؛ مسیر hit بهینه است.
- Documentation: README مختصر؛ نیاز به شفاف‌سازی مسیرها.

